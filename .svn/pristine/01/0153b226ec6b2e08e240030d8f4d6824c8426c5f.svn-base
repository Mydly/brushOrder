import {
    MemoryRouter as Router,
    Route,
    Redirect,
} from 'react-router-dom';
import { connect } from 'react-redux';
import React, { PropTypes } from 'react';

import '../static/style/common.scss';

import Nav from '../component/view/Nav';
//import BootNavBar from '../component/view/BootNavBar';
//import Content from '../component/view/Content';
import Index from '../component/view/Index';
import Trade from '../component/view/Trade';
import Finan from '../component/view/Finan';
import Safe from '../component/view/Safe';
//import MyFinan from '../component/MyFinan/MyFinan';
//import CoinIn from '../component/MyFinan/CoinIn';
//import CoinOut from '../component/MyFinan/CoinOut';
//import FinanCharge from '../component/MyFinan/FinanCharge';
//import FinanMoney from '../component/MyFinan/FinanMoney';    //账户提现
//


//import Issue from '../component/view/Issue';
//import Money from '../component/view/Money';
//import Vote from '../component/view/Vote';
//import Login from '../component/view/Login';
//import UserInfo from '../component/Login/UserInfo';


import CONSTS, { PageKey, AlertType } from '../config/consts';
import { changeTab, tabChangeAction } from '../actions/topNav';
import { alog } from  '../function/common';

class RouteList extends React.Component{
    constructor(props) {
        super(props);

        this.handleLogin = this.handleLogin.bind(this);
        this.appendCount = 0;
        alog('出现次数 初始化 0');
    }

    //组件初始化
    componentDidMount(){
        alog('出现次数 '+(++this.appendCount));

    }

    //组件将更新
    componentWillUpdate(){
        alog('出现次数 '+(++this.appendCount));
    }

    handleLogin(e){
        e.preventDefault();
        console.log(e);
        const {change} = this.props;
        change(PageKey.login.key);
    }

    render(){

        let tabBar = this.props.tabBar;
        let content = null;
        switch(tabBar){
            case CONSTS.pageKey.daohang[0].key:
                content = <Index />;
                break;
            case CONSTS.pageKey.daohang[1].key:
                content = <Trade />;
                break;
            case CONSTS.pageKey.daohang[2].key:
                content = <Finan />;
                break;
            case CONSTS.pageKey.daohang[3].key:
                content = <Safe />;
                break;
        }


        return (
            <div>
                <Nav />
                {content}
            </div>
        );
    }
}

function mapStateToProps(state) {

    console.log('state ========');
    console.log(state);

    return {
        tabBar: state.topNav.tabBar,
        lastBar:state.topNav.lastBar,
        alert:state.alert,
        userinfo:state.topNav.userinfo
    };
}

const mapDispatchToProps = (dispatch) => {
    return {
        change:(tab) => {
            dispatch(tabChangeAction(tab))
        }}
}

function Routes() {

    console.log('routes this======');
    console.log(this);

    return (
        <Router>
            <div>
                <Route path="/" component={connect(mapStateToProps, mapDispatchToProps)(RouteList)} />
            </div>
        </Router>
    );
}

export default Routes;
