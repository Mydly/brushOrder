/**
 * Created by Administrator on 2017/4/13.
 */
var React = require('react');
var CommentForm = React.createClass({

    getInitialState(){
        return {author:'',text:''}
    },
    handleAuthorChange(e){
        this.setState({author:e.target.value});
    },
    handleTextChange(e){
    this.setState({text:e.target.value});
    },
    handlePost(e){
        e.preventDefault();

        //var str = '提交数据:';
        //str += '\nauthor:'+this.state.author.trim();
        //str += '\ntext:'+this.state.text.trim();
        console.log(this.state);


        var xhr = new XMLHttpRequest();
        xhr.open("POST",this.props.postUrl,true);
        xhr.send(this.state);
        xhr.onreadystatechange = function() {
            if(xhr.readyState == 4 && xhr.status == 200) {
                console.log(xhr.responseText)
            }
        }.bind(this);
        this.setState( {author:'',text:''});
    },

    render(){
        return (
            <form className="commentForm" onSubmit={this.handlePost}>
                <input type="text" placeholder="Your name" value={this.state.author} onChange={this.handleAuthorChange}/>
                <input type="text" placeholder="Say something..." value={this.state.text} onChange={this.handleTextChange}/>
                <input type="submit" value="Post"/>
            </form>
        );
    }
});

module.exports = CommentForm;